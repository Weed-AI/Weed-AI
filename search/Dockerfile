# For Production
FROM nginx:latest

# build node package
ENV NODE_VERSION=12.0.0
RUN apt update
RUN apt install -y npm
RUN npm install -g yarn
RUN mkdir /code /code/public /code/src
COPY public /code/public
COPY src /code/src
COPY package.json yarn.lock /code/
RUN cd /code && find . && yarn install && yarn run build

# TODO: uninstall node

RUN mkdir /app
RUN cp -R /code/build/* /app/

COPY ./nginx/react/nginx.conf /etc/nginx/nginx.conf
